<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    {{ $.Scratch.Set "Title" (default .Title (index .Site.Params.text (print "title_" (lower .Title)))) }}
    <title>{{ if eq ($.Scratch.Get "Title") .Site.Title }}{{ .Site.Title }}{{ else }}{{ ($.Scratch.Get "Title") }} | {{ .Site.Title }}{{ end }}</title>

    {{ $css_options := dict "targetPath" "css/style.css" "includePaths" (slice "assets/scss")}}
    {{- if (in (slice (getenv "HUGO_ENV") hugo.Environment) "production") -}}
      {{- $css_options = merge $css_options (dict "outputStyle" "compressed") -}}
    {{- end -}}
    {{ $sass_template := resources.Get "scss/main.scss" }}
    {{ $style := $sass_template | resources.ExecuteAsTemplate "main_parsed.scss" . | toCSS $css_options }}
    {{- if (eq (getenv "HUGO_ENV") "production") -}}
      {{- $style = $style | minify | fingerprint "md5" -}}
    {{- end -}}
    <link rel="stylesheet" href="{{ $style.RelPermalink }}">

    {{ partial "head_custom.html" . }}
  </head>

  <body{{if .IsPage}} class="page"{{ end }}>
    <nav class="header">
      {{ partial "banner.html" . }}
      {{ partial "head_meta.html" . }}
    </nav>